if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("LSFetchBackupIds",["LSAppendDataTraceAddon","LSCreateDataTraceID.bs","LSIssueNewTask","qex"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(e){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsFetchBackupIdsStoredProcedure]Beginning execution."),d[1]=function(a){return a==f?f:a}(b("qex")._("1229")),d[1]!==f?d[0]=d[1]:d[0]=!0,d[0]?c.seq([function(e){return a[1]!==f?c.seq([function(b){return d[7]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils]",d[7],"EncryptedBackups Trace ID",d[7],c.i64.to_string([0,69])].join("")),c.db.table(153).add({traceId:a[1],initTimestampMs:c.i64.of_float(Date.now()),traceType:[0,69],shouldFlush:!1,contextThree:"fetch_backup_status"})},function(b){return d[2]=a[1]}]):c.seq([function(a){return c.islc(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])&&c.i64.eq(a.backupTenancy,[0,2])}),0,c.i64.to_float([0,1])).next().then(function(a,b){b=a.done;a=a.value;return b?d[7]=!1:(a.item,d[7]=!0)})},function(a){return d[7]?d[9]=c.i64.or_([0,69],[0,128]):d[9]=[0,69],c.nop(b("LSCreateDataTraceID.bs")).then(function(a){return a=a,d[10]=a[0],a})},function(a){return d[11]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils]",d[11],"EncryptedBackups MCD Trace ID",d[11],c.i64.to_string(d[9])].join("")),c.db.table(153).add({traceId:d[10],initTimestampMs:c.i64.of_float(Date.now()),traceType:d[9],shouldFlush:!1,contextThree:"fetch_backup_status"})},function(a){return d[12]=!1,d[12]?d[13]=!0:d[13]=!1,d[13]?function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"):0,d[2]=d[10]}])},function(a){return d[2]!==f?c.sp(b("LSAppendDataTraceAddon"),d[2],[0,1468],[0,2],f,f):c.resolve()},function(a){return d[3]=!1,d[3]?d[4]=!0:d[4]=!1,d[4]?function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"):0,c.fe(c.db.table(172).fetch(),function(a){return a["delete"]()})},function(a){return c.fe(c.ftr(c.db.table(172).fetch([[[[0,1]]]]),function(a){return c.i64.eq(a.pk,[0,1])&&c.i64.lt(a.authorityLevel,[0,20])}),function(a){return a["delete"]()})},function(b){return c.db.table(172).add({pk:[0,1],authorityLevel:[0,20],backupTenancy:a[0]})},function(e){return d[5]=new c.Map(),d[5].set("backup_tenancy",a[0]),d[5].set("trace_id",d[2]),d[6]=c.toJSON(d[5]),c.sp(b("LSIssueNewTask"),"encrypted_backups_setup",[0,50008],d[6],f,f,[0,0],[0,0],f,f,[0,0])}]):c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsFetchBackupIdsStoredProcedure]FetchBackupsId flow is disabled"),c.fe(c.db.table(172).fetch(),function(a){return a["delete"]()})},function(a){return c.fe(c.ftr(c.db.table(172).fetch([[[[0,1]]]]),function(a){return c.i64.eq(a.pk,[0,1])&&c.i64.lt(a.authorityLevel,[0,80])}),function(a){return a["delete"]()})},function(a){return c.db.table(172).add({pk:[0,1],backupId:[-1,4294967295],authorityLevel:[0,80]})}])},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsFetchBackupIdsStoredProcedure]Finishing execution.")}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("ReStoreEARSetupFailure",[],(function(a,b,c,d,e,f){"use strict";var g="Encryption keychain could not be setup",h="ReStoreEARSetupFailure";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;b=g+": "+b;c=a.call(this,b)||this;c.message=b;c.name=h;return c}return b}(babelHelpers.wrapNativeSuper(Error));f.ERROR_MESSAGE=g;f.ERROR_NAME=h;f.ReStoreEARSetupFailure=a}),66);
__d("LSPlatformLogout.bs",["LSCookie.bs","LSPlatformClientProvider.bs","Promise","Promise.bs","QPLUserFlow","bs_curry","cr:4318","qpl","react"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=h.useContext(b("LSPlatformClientProvider.bs").context);return h.useCallback(function(a){if(b("cr:4318")==null)return b("Promise").resolve(void 0);else{b("QPLUserFlow").start(b("qpl")._(25311266,"236"),{cancelOnUnload:!0,timeoutInMs:3e3});c!==void 0&&b("bs_curry")._1(c.cleanup,void 0);return b("Promise.bs").$$catch(b("Promise").all([b("bs_curry")._1(b("cr:4318").deleteDB,void 0),b("LSCookie.bs").deleteCookie(void 0)]).then(function(a){b("QPLUserFlow").endSuccess(b("qpl")._(25311266,"236"),void 0);return b("Promise").resolve(void 0)}),function(a){b("QPLUserFlow").endFailure(b("qpl")._(25311266,"236"),"fail",void 0);return b("Promise").resolve(void 0)})}},[c])}f.$LSPersistedDatabaseProvider$requireCond=b("cr:4318");f.useHook=a}),null);